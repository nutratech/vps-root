# Map bad request patterns to a variable
map $request_uri $bad_request {
    default 0;

    # Git probing
    "~^.*/\.git/config" 1;
    "~^.*/\.env" 1;

    # Deep commit scraping (generic hash-like path segments)
    "~^.*/(commit|blame|raw|src/commit)/[a-f0-9]+" 1;

    # Specific known scanner paths
    "~^.*/_next/" 1;
    "~^.*/api/route" 1;
    "~^.*/SDK/webLanguage" 1;
    "~^.*/v(1|2)\?.*=project_list" 1;
    "~^.*/(tg-svelte|gamesguru)/.*" 1;

    # Sensitive files
    "~^.*/wp-config\.php" 1;
    "~^.*/config\.php" 1;
    "~^.*/credentials" 1;
}
